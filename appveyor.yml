environment:
  PATH: $(APPDATA)\npm;$(PATH)
  VisualStudioVersion: 14.0

install:
  - ps: Install-Product node 6.9.1
  - npm install typescript@latest -global
  - npm install tfx-cli@latest -global
  - npm install nyc -global
  - npm install mocha -global
  - npm install mocha-appveyor-reporter -global
  - ps: Import-Module .\build\BuildFunctions.psm1

before_build:
  - ps: InitAll (GetTypeScriptTaskModules)

before_package:
  - ps: Package (GetTypeScriptTaskModules)

test_script:
  - ps: TestAll (GetTypeScriptTaskModules), "mocha-appveyor-reporter"

artifacts:
  - path: ./bin/*.vsix
    name: ExtensionPackage
